import{a6 as f,r as o,a7 as m,u as O,a as p,j as s,a8 as y,B as D,a9 as R,aa as F,M as d}from"./index.51c4d091.js";import{C as _}from"./index.d3e83608.js";import{T as A}from"./index.584e612b.js";import{P as E}from"./index.086f4247.js";import{i as H,S as J,s as N}from"./form.550f0169.js";import{getColumns as K}from"./constants.52c12998.js";import"./b-tween.es.064e2a03.js";import"./index.c55eac46.js";import"./index.252a6895.js";import"./index.9bec4a91.js";function U(r){return f({url:"/tag/query",method:"post",data:r})}function G(r){return f({url:"/tag/create",method:"post",data:r})}function Q(r){return f({url:"/tag/delete",method:"post",data:r})}function X(r){return f({url:"/tag/update",method:"post",data:r})}function ne(){const[r,n]=o.exports.useState(!1),[w,c]=o.exports.useState(!1),[g,h]=o.exports.useState(""),[l]=m.useForm(),a=O(H),[i,b]=o.exports.useState({sizeCanChange:!0,showTotal:!0,pageSize:10,current:1,pageSizeChangeResetCurrent:!0}),[C,k]=o.exports.useState({}),P=async(e,t)=>{t=="edit"&&(h(e.uuid),l.setFieldValue("tagName",e.tag_name),l.setFieldValue("tagDescription",e.tag_description),n(!0)),t=="delete"&&I(e.uuid)},v=o.exports.useMemo(()=>K(a,P),[a]),[z,L]=o.exports.useState([]),[W,S]=o.exports.useState(!0);o.exports.useEffect(()=>{u()},[i.current,i.pageSize,JSON.stringify(C)]);function u(){const{current:e,pageSize:t}=i;S(!0),U({page:e,pageSize:t,...C}).then(T=>{L(T.data.pageData),b({...i,current:e,pageSize:t,total:T.data.total}),S(!1)})}function I(e){S(!0),Q({uuid:e}).then(t=>{t.data.code===0?u():d.error(t.data.message)})}function j(e){c(!0),g?X({uuid:g,...e}).then(t=>{t.data.code===0?(d.success(a["form.submitSuccess"]),u(),n(!1),x()):d.error(t.data.message),c(!1)}):G({...e}).then(t=>{t.data.code===0?(d.success(a["form.submitSuccess"]),n(!1),u(),x()):d.error(t.data.message),c(!1)})}function x(){n(!1),c(!1),l.resetFields()}function M(){h(""),n(!0)}const V={labelCol:{span:4},wrapperCol:{span:20}};function q({current:e,pageSize:t}){b({...i,current:e,pageSize:t})}function B(e){b({...i,current:1}),k(e)}return p("div",{children:[p(_,{children:[s(J,{onSearch:B}),s(E,{children:p("div",{className:N["button-group"],children:[s(y,{children:s(D,{onClick:()=>{M()},type:"primary",children:a["searchTable.operations.add"]})}),s(y,{children:s(D,{onClick:()=>{u()},type:"primary",children:a["searchTable.operations.reload"]})})]})}),s(A,{rowKey:"id",loading:W,onChange:q,pagination:i,columns:v,data:z})]}),s(R,{width:400,title:g?a["drawer.title.edit"]:a["drawer.title.add"],visible:r,confirmLoading:w,okText:a["form.button.text"],onOk:()=>{l.validate().then(e=>{j(e)})},onCancel:()=>{h(""),n(!1),c(!1),l.resetFields()},children:p(m,{...V,form:l,layout:"vertical",children:[s(m.Item,{label:a["form.tagName"],field:"tagName",rules:[{required:!0,message:a["form.tagName.placeholder"]}],children:s(F,{placeholder:a["form.tagName.placeholder"]})}),s(m.Item,{label:a["form.tagDescription"],field:"tagDescription",children:s(F.TextArea,{style:{minHeight:100},className:N["arco-input"],placeholder:a["form.tagDescription.placeholder"]})})]})})]})}export{ne as default};
