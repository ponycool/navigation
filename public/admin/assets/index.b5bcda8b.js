import{aO as g,r as i,y as m,u as q,a as p,j as r,x as D,B as F,aP as R,z as T,M as f}from"./index.42860b0d.js";import{C as _}from"./index.d374f698.js";import{T as H}from"./index.3780e150.js";import{P as J}from"./index.82c0df44.js";import{i as K,S as U,s as w}from"./form.92ac7ff2.js";import{getColumns as G}from"./constants.35a6e194.js";import"./b-tween.es.064e2a03.js";import"./index.3337ff1c.js";import"./index.3eea0c4b.js";import"./index.558791e7.js";function Q(s){return g({url:"/tag/query",method:"post",data:s})}function X(s){return g({url:"/tag/create",method:"post",data:s})}function Y(s){return g({url:"/tag/delete",method:"post",data:s})}function Z(s){return g({url:"/tag/update",method:"post",data:s})}function ue(){const[s,u]=i.exports.useState(!1),[N,c]=i.exports.useState(!1),[h,b]=i.exports.useState(""),[l]=m.useForm(),a=q(K),[n,C]=i.exports.useState({sizeCanChange:!0,showTotal:!0,pageSize:10,current:1,pageSizeChangeResetCurrent:!0}),[y,P]=i.exports.useState({}),k=async(e,t)=>{t=="edit"&&(b(e.uuid),l.setFieldValue("tagName",e.tag_name),l.setFieldValue("tagDescription",e.tag_description),u(!0)),t=="delete"&&W(e.uuid)},z=i.exports.useMemo(()=>G(a,k),[a]),[A,E]=i.exports.useState([]),[L,S]=i.exports.useState(!0);i.exports.useEffect(()=>{d()},[n.current,n.pageSize,JSON.stringify(y)]);function d(){const{current:e,pageSize:t}=n;S(!0),Q({page:e,pageSize:t,...y}).then(o=>{E(o.data.pageData),C({...n,current:e,pageSize:t,total:o.data.total}),S(!1)})}function W(e){S(!0),Y({uuid:e}).then(t=>{t.data.code===0?d():f.error(t.data.message)})}const j=e=>Object.entries(e).reduce((t,[o,x])=>(x!=null&&(t[o]=x),t),{}),v=async e=>{c(!0);try{const t=j(e);let o;h?o=await Z({uuid:h,...t}):o=await X(t),o.data.code===0?(f.success(a["form.submitSuccess"]),u(!1),d(),B()):f.error(o.data.message)}catch(t){f.error("\u63D0\u4EA4\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),console.error("\u63D0\u4EA4\u51FA\u9519:",t)}finally{c(!1)}};function B(){u(!1),c(!1),l.resetFields()}function I(){b(""),u(!0)}const O={labelCol:{span:4},wrapperCol:{span:20}};function V({current:e,pageSize:t}){C({...n,current:e,pageSize:t})}function M(e){C({...n,current:1}),P(e)}return p("div",{children:[p(_,{children:[r(U,{onSearch:M}),r(J,{children:p("div",{className:w["button-group"],children:[r(D,{children:r(F,{onClick:()=>{I()},type:"primary",children:a["searchTable.operations.add"]})}),r(D,{children:r(F,{onClick:()=>{d()},type:"primary",children:a["searchTable.operations.reload"]})})]})}),r(H,{rowKey:"id",loading:L,onChange:V,pagination:n,columns:z,data:A})]}),r(R,{width:400,title:h?a["drawer.title.edit"]:a["drawer.title.add"],visible:s,confirmLoading:N,okText:a["form.button.text"],onOk:()=>{l.validate().then(e=>{v(e)})},onCancel:()=>{b(""),u(!1),c(!1),l.resetFields()},children:p(m,{...O,form:l,layout:"vertical",children:[r(m.Item,{label:a["form.tagName"],field:"tagName",rules:[{required:!0,message:a["form.tagName.placeholder"]}],children:r(T,{placeholder:a["form.tagName.placeholder"]})}),r(m.Item,{label:a["form.tagDescription"],field:"tagDescription",children:r(T.TextArea,{style:{minHeight:100},className:w["arco-input"],placeholder:a["form.tagDescription.placeholder"]})})]})})]})}export{ue as default};
